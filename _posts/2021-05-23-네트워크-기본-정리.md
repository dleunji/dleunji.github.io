---
Title : "네트워크"
layout : post
date : 2021-05-12
category : Network
blog : true
author : dleunji
description : 중간고사 내용 포함 정리
---

아무래도 중간고사 때 개념을 미흡하게 익혀서 시험 때 많이 당황했다. 다행히 운이 따라줘서 좋은 성적이 나왔으나 솔직히 운빨이었다.. 

기말고사에는 미리미리 중간고사 복습부터 하려고 도서관에서 최신 네트워크 책을 빌려서 읽고 중요한 내용은 여기에 아카이빙하고자 한다.



### MAC 주소

비고정적인 IP주소와 달리 랜카드(NIC)가 바뀌지 않는 이상 단말장치의 고정적인 주소이다. 16진수로 이루어졌고, 12개의 문자로 이루어져있다. 즉 이진수로 나타내면 총 **48bits**.

예를 들어 나의 회사 맥북 주소는 `ac:de:48:00:11:22` 이다. 이진수로 나타내면 1010 1100:1101 1110:0100 1000:0000 0000:0001 0001:0010 0010이다. 

16진수를 2진수로 나타내기 위해서 4bits 단위로 나누면 된다!

<img width="863" alt="스크린샷 2021-05-23 오후 9 23 24" src="https://user-images.githubusercontent.com/46207836/119260367-75b00a00-bc0d-11eb-9d3e-30ca1bc5697c.png">

MAC 주소는 이론적으로 2^48개의 주소를 지정할 수 있으나 이 중에서 이미 고정되어 자유롭게 할당할 수 없는 MAC 주소가 하나 있다. 바로 브로드캐스트 주소이다. 사실 브로드캐스트의 경우 목적지를 지정할 필요가 없다.

그럼에도 데이터를 보내기 위해서는 도착지 MAC 주소가 반드시 필요하기 때문에 데이터를 보낼 목적지 주소를 특정하기 어려운 브로드캐스트 통신 방식에서는 MAC 주소 체계로 표현할 수 있는 주소값 중에서 맨 마지막 값인 'FF:FF:FF:FF:FF:FF'를 브로드캐스트 주소로 지정하여 목적지 MAC 주소로 활용한다.



### IP 주소의 체계

IP는 Internet Protocol의 약자로 인터넷 통신을 위한 일련의 통신 규칙들을 지칭, 이런 IP 기반 네트워크 환경에서 단말장치들이 서로 인식하고 통신을 하기 위해 지정되는 주소체계를 바로 IP 주소라고 한다. 반드시 인터넷이 아니더라도 데이터 기반 네트워크 환경에서 컴퓨터와 같은 단말장치가 통신을 하기 위해서는 IP 주소가 필요하다. 고정적인 IP 주소 설정도 가능하나, 보통 NIC에 연결되는 네트워크에 따라 주소값이 동적으로 변경된다.



**IPv4**

- 4byte(**32bits**) size
- 1byte마다 octet으로 구분한다.
- 0.0.0.0 ~ 255.255.255.255



MAC 주소의 경우 2^48개, IPv4주소 체계로는 2^32개 표현 가능하여 부족하다.

네트워크 규모가 커질수록 단말장치의 수는 점점 늘어나게 될 것이고, IP 주소의 고갈을 걱정

**IPv6**

- 16byte(**128bits**) size
- IPv4보다 16배나 더 많이 만들 수 있다.(2^32 → 2^128)
- 16bit 당 콜론으로 8개 구간 구분
- e.g. 3215:ABD5:3CFE:3991:9833:15CE:35D1:0000

| 구분     | IPv4                                                         | IPv6                                                         |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 주소길이 | 32bit                                                        | 128bit                                                       |
| 주소개수 | 2^32                                                         | 2^128                                                        |
| 주소형태 | - 8비트당 **octat(.)**으로 4개 구간 구분<br />- 각 구간별 수는 **10진수**로 표기 | - 16bit당 **콜론(:)**으로 8개 구간 구분<br />- 각 구간별 수는 16진수로 표기 |
| 표기예제 | 192.168.231.244                                              | 3215:ABD5:3CFE:3991:9833:15CE:35D1:0000                      |



### NAT

- 네트워크 주소 변환(Network Address Translation)
- 사설망과 공인망 사이의 통신
- 사설망의 IP 주소를 공인 IP 주소로 변경하여 데이터를 중계
- 네트워크 장비는 사설 IP와 공인 IP를 모두 가지고 있으며, 자신을 지나는 데이터의 사설 IP 주소를 공인 IP 주소로 바꾸어 중계
- 사설 IP 주소를 외부로 숨길 수 있어 외부망에서 내부 사설망으로 접근하는 것을 막을 수 있다.

![image](https://user-images.githubusercontent.com/46207836/119261893-4cdf4300-bc14-11eb-985f-f79cddd17266.png)

### 서브넷마스크

네트워크에 연결된 단말장치들은 각각 고유의 IP 주소를 가지고 있으며, 해당 IP 주소를 기준으로 '서로 같은 네트워크' 혹은 '서로 다른 네트워크'로 구분된다. 즉, 각각의 IP 주소를 가지는 단말 장치들이 해당 IP 주소를 기준으로 동일한 네트워크로 묶여 서로 통신할 수 있지만, 서로 다른 네트워크에 소속되어 통신을 할 수 없는 경우도 있다.

그러면 IP 주소를 가지고 '서로 같은 네트워크'와 '서로 다른 네트워크'를 어떻게 구분할 수 있을까?

전체 IP 주소범위를 일정 단위 그룹으로 나누고, 해당 단위 그룹 중 동일한 그룹의 IP주소를 가지는 단말장치들끼리는 '서로 같은 네트워크'에 속한다고 본다. 반면에 서로 다른 그룹의 IP 주소 범위를 가지는 단말 장치들끼리는 '서로 다른 네트워크'에 속한다고 할 수 있다.

이 때 전체 IP 주소가 단위 그룹으로 나뉘도록 필터링해주는 수단이 바로 서브넷마스크

- AND 연산 활용



### IP 주소의 클래스

전체 클래스는 A,B,C,D,E의 5개로 구분되며, 이 때 IP 클래스에 따라 IP 주소의 구조가 결정된다. 

IP는 클래스별로 크게 네트워크 ID(Network ID), 호스트 ID(Host ID)로 나뉘며, 각 클래스마다 네트워크 ID와 호스트ID 영역의 길이가 다르다. 

**네트워크 ID** : IP주소에서 고정된 주소 값을 가지는 첫 번째 영역으로, 네트워크의 주소를 나타낸다.

**호스트ID** : 네트워크ID 영역을 제외한 나머지 IP 주소 영역으로 단말장치의 주소를 나타낸다.

네트워크 ID와 호스트 ID를 기반으로 결정되는 IP 주소 범위를 바로 IP클래스라고 하며, 각 클래스별 서브넷마스크를 **디폴트 서브넷 마스크**라고 한다.

**디폴트 서브넷 마스크** : **네트워크 ID 영역에 비트 수만큼 1을 값으로 주고, 나머지 호스트ID 영역에는 비트 수만큼 0을 값으로** 주어 이를 10진수로 변환해 IP 주소 형태로 나타낼 수 있다. (이때 네트워크 ID 영역을 2진수 1로 표시하는 이유는 네트워크 ID 영역의 주소값을 AND 연산으로 처리하기 위함)

그리고 1을 값으로 준 네트워크ID 영역의 전체 비트 수를 서브넷마스크 비트 수, 나머지 호스트 ID 영역의 비트 수를 호스트 비트 수라고 정의한다. 



**클래스 A**

IP주소 중 전반부 8bit를 네트워크 ID 영역으로 정의하고 후반부 24bit를 호스트 ID 영역으로 구분하고, 최상위 첫 번째 비트는 반드시 0을 공통된 값으로 가진다.

**클래스 B**

IP주소 중 전반부 16bit를 네트워크 ID 영역으로 정의하고, 나머지 16bit는 호스트 영역이다. 그리고 2진수로 나타낸 IP주소 중 최상위 2개의 비트가 1, 0인 16bit길이의 네트워크 ID 구간을 10진수로 변환하면 128.0부터 191.255까지다. 즉 첫 번째 8bit 값이 128~191까지의 범위로 64개, 두 번째 8 bit값이 0에서 255까지의 범위로 256개 이므로 클래스 B는 64 * 256 = 16,384개의 네트워크 주소를 설정할 수 있다.

호스트ID는 8bit 옥텟(.) 간격으로 구분된 2개의 영역으로 구성되며,  전체 사이즈가 16bit다. 8bit로 된 각 영역을 10진수로 변환하면 0부터 255까지의 값이 된다. 따라서 전체 호스트 ID 0.0부터 255.255까지의 단말장치 주소값을 가질 수 있다. 즉 이론적으로 클래스 B는 앞의 네트워크 ID와 호스트 ID를 합쳐서 128.0.0.0 ~ 191.255.255.255까지의 IP주소를 사용할 수 있는 것이다.

그러나 클래스 A의 경우와 마찬가지로 실제로 IP 주소 전체를 사용할 수는 없다. RFC 문서에 따르면, 클래스 B에서는 일부 IP주소에 대해 특별한 목적으로 이미 사용처가 예약되어 있기 때문이다.

네트워크 ID가 164.2인 네트워크에서 총 16bit 길이의 호스트 ID를 가지고 할당할 수 있는 단말장치의 IP 주소는 총 2^16개지만, 여기서 네트워크의 IP주소와 브로드캐스트 IP주소를 빼면 실제로 단말장치에 할당할 수 있는 IP 주소는 2^16 - 2 = 65,534개가 된다.

그리고 여기서 네트워크 ID 영역이 16bit이므로 서브넷마스크 비트 수는 16이 되고, 호스트 ID의 길이는 16bit이므로 호스트 비트 수는 16으로 정의할 수 있다. 여기서 서브넷마스크 비트 수만큼 1을, 호스트 비트 수만큼 0을 값으로 주고 이를 10진수로 변환해 IP 주소 형식으로 나타내면 255.255.0.0이 된다. 이 주소값이 클래스 B의 서브넷 마스크이다. 

**클래스 C**

클래스 C는 IP 주소의 앞 24bit 영역을 네트워크 ID로 정의하고 나머지 8 bit 영역을 호스트 ID로 구분한다. 그리고 2진수로 나타낸 IP 주소 중 맨 앞 세 개의 비트가 1,1,0이라는 공통값을 가지는 IP 주소다. 여기서 네트워크ID 구간을 10진수로 변환하면 192.0.0 ~ 223.255.255까지 표현가능하다.

만약 클래스C의 네트워크ID가 195.110.25라면, 뒤에 있는 호스트 ID와 합쳐서 실제 단말장치에 할당할 수 있는 IP 주소 범위는 195.110.25.0부터 195.110.25.255까지다. **하지만 195.110.25.0은 네트워크 ID가 195.110.25인 네트워크 주소를 나타내기 때문에 이미 할당되어 있고, IP 주소 195.110.25.255는 네트워크 통신 방식 중 하나인 브로드캐스트를 위한 IP로 할당되어 있다.** 그러므로 실제 단말장치에 할당할 수 있는 IP 주소 범위는 195.110.25.1부터 195.110.25.254까지다.(2^8 - 2 = 254개)

클래스 C의 서브넷 마스크는 255.255.255.0이다.

![image](https://user-images.githubusercontent.com/46207836/120210063-53039e00-c26a-11eb-844a-3b414304b514.jpeg)

**클래스 D**

클래스D는 최상위 네 개의 비트가 1,1,1,0을 공통 값으로 가지는 IP 주소 범위다. 여기서 네 개의 최상위 비트의 값이 1,1,1,0인 비트의 값을 고정으로 하는 IP 주소 범위는 10진수로 변환하면 224.0.0.0 ~ 239.255.255.255까지다. 하지만 클래스 D의 IP 주소는 멀티캐스트 IP 주소로 이미 예약되어 있기 때문에 클래스 D의 IP 주소를 단말장치에 할당하여 사용할 수는 없다. 그래서 클래스 D부터는 네트워크 ID와 호스트 ID로 영역을 구분하지 않는다. 어차피 단말장치에 할당하기 위한 주소가 없기 때문이다.

**클래스 E**

클래스 E는 IP 주소 최상위 네 개의 비트가 1,1,1,1을 공통 값으로 가지는 IP주소 범위다. 여기서 네 개의 최상위 비트의 값이 1,1,1,1인 IP 주소 범위를 10진수로 변환하면 240.0.0.0 ~ 255.255.255.255까지다. 하지만 클래스 E의 IP 주소는 연구 및 특수 목적으로 이미 예약되어 있어 클래스 D와 마찬가지로 단말장치에 할당하여 사용할 수 없다.



**CIDR**

보통 IP 주소는 서브넷마스크를 함께 표시한다. IP 주소 옆에 빗금 기호를 주고 서브넷 마스크를 서브넷 마스크 비트 수로 간단히 나타낸다.

Q. 어떤 단말장치에 IP 주소 220.85.93.23/24를 받았다. 이 IP 주소가 속한 네트워크 주소, 그리고 이 단말장치와 동일한 네트워크를 가지는 단말장치들의 IP 범위는?

- 네트워크 주소: 220.85.93.0
- 브로드캐스트 주소: 220.85.93.255
- 단말장치 IP 범위: 220.85.93.1 ~. 220.85.93.254(총 254개)





