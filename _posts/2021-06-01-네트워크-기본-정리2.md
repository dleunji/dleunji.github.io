---

Title : "네트워크2"
layout : post
date : 2021-06-01
category : Network
blog : true
author : dleunji
description : 중간고사 내용 포함 정리
---

### 서브넷팅

하나의 큰 네트워크를 필요한 만큼 네트워크 영역으로 나누어 사용하는 방식을 서브넷팅(Subnetting)이라고 한다. 그리고 이 때 나누어진 네트워크를 서브넷(Subnet)이라고 한다.

서브넷팅에서는 디폴트 서브넷 마스크가 아닌 다른 서브넷마스크 값으로 단말장치의 IP 주소 범위를 결정할 수 있다. 

예를 들어 194.172.181.7/25라는 네트워크가 주어졌다고 가정해보자. 주어진 네트워크를 살펴보면 IP 주소는 클래스 C에 속하는 194.172.181.7이고, 서브넷마스크 비트 수는 25임을 알 수 있다. 그런데 클래스 C의 경우 디폴트 서브넷마스크가 255.255.255.0이므로 이를 서브넷마스크 비트 수로 변환하면 24가 된다.

예시에서 주어진 서브넷마스크 비트 수는 25이므로 클래스 C의 디폴트 서브넷마스크와의 전혀 다른 값을 가진다. 즉 194.172.181.7이라는 IP 주소는 우리가 알고 있는 디폴트 서브넷마스크와는 전혀 다른 네트워크 범위에 속한다.



### 194.172.181.7/25의 네트워크 IP와 호스트 IP 범위는?

우선 서브넷 마스크 비트 수가 25 → 네트워크 ID의 영역의 사이즈도 25bit가 된다. 

나머지 7 bit가 호스트 ID 영역이다.

네트워크 주소(네트워크 IP)를 계산하기 위해 서브넷 마스크(255.255.255.128)와 IP 주소(194.172.181.7)를 2진수로 변환해주고 AND 연산을 수행한다. 그러면 네트워크 주소(네트워크 IP )주소는 194.172.181.0이 되고, 브로드 캐스트 IP 주소는 194.172.181.127이 된다. 네트워크 주소와 브로드캐스트 주소를 제외하고 단말장치에 할당할 수 있는 IP주소(호스트 IP)의 범위는 194.172.181.1 ~ 194.172.181.126로 총 126개이다.

원래 클래스 C에 속하는 IP주소 194.172.181.7은 네트워크 주소가 194.172.181.0이고 디폴트 서브넷마스크 비트 수는 24이다. 따라서 이 네트워크에서 단말장치에 할당 가능한 IP 주소(호스트 IP) 범위는 194.172.181.1 ~ 194.172.181.254다.

하지만 서브넷마스크 비트 수가 디폴트 서브넷마스크 비트 수보다 1이 늘어난 25가 되면서 호스트 IP 주소 범위는 194.172.181.1 ~ 194.172.181.126으로 기존 클래스 C의 호스트 IP 주소 범위의 딱 절반이 된 것이다. 

이를 통해, 서브넷마스크를 통한 최적화된 네트워크 자원 활용이 가능해졌다. 

![image](https://user-images.githubusercontent.com/46207836/120333415-a0474480-c32a-11eb-906d-70898167ff96.png)

예를 들어 서브넷마스크 비트 수가 26이라는 것은 서브넷 마스크를 2진수로 표현할 때 1값을  26개 가진다는 의미이다. 그래서 32bit 길이의 IP 주소에서 2진수 1을 26개 넣으면 마지막 8bit 영역에서는 첫 2bit 구간만 1값을 가지고 나머지 6bit 영역은 0만 가지게 된다.

서브넷의 수 = 2^n개

호스트 IP의 수 = 2^(8-n) - 2개



### Bandwidth

- 대역폭
- 전파신호에서 대역폭 
  - 특정 구간의 주파수 범위를 의미
  - 단위는 Hz
  - 예를 들어 4dB 이상 세기의 전파신호가 필요한 경우, 주파수 구간은 10Hz ~ 20Hz 범위를 가진다.
  - 특정 신호 세기를 보장하기 위한 주파수 범위
- 네트워크 전송 채널에서 대역폭
  - 해당 전송채널을 통해서 전송되는 데이터양의 범위
  - 단위는 BPS(bits per second)
  - 즉, 하나의 네트워크에서 한 번에 수용하고 처리할 수 있는 데이터의 양
  - 네트워크 대역폭(bps) = 전송된 데이터의 양(bit) / 데이터 전송 시간(sec)
  - 속도와 밀접

### LAN & WAN

![image](https://user-images.githubusercontent.com/46207836/120339601-36319e00-c330-11eb-9d90-5e7f2610537a.png)



### 이더넷

LAN, WAN에 적용되는 프로토콜(네트워크 통신과 관련된 모든 대상에게 공통으로 적용되는 하나의 규약)

- 프로토콜

  - 호환성 문제 해결
  - 네트워크에서도 통신하고자 하는 컴퓨터마다 네트워크에 데이터를 보내고 받는 방식이 모두 다르다면 메시지를 주고받기가 어렵다.

- 이더넷 기반의 통신 방식으로는 대표적으로 **CSMA/CD**

  - 서로 눈치를 보는 소심한 통신 방식
  - Carrier Sense Multiple Access/Collison Detection
    - 반송파 감지 : 컴퓨터가 통신을 하고자할 때, 네트워크 회선이 사용 중인 경우 바로 데이터를 보낼 수 없으므로, 그보다 앞서 다른 컴퓨터가 네트워크 회선을 통하여 데이터를 송신 중인지 모니터링
    - 다중 접속 : 네트워크가 반송파를 감지해서 네트워크가 현재 비어있다면, 어느 컴퓨터가 되었든 네트워크를 통해 메시지를 보낼 수 있는 특징
    - 충돌 감지: 메시지 충돌이 발생한 경우 메시지를 보낸 컴퓨터들은 이를 감지하고 임의의 시간동안 대기한 후에 메시지를 재전송
- 순서가 정해져 있지는 않지만 메시지를 동시에 보내서 충돌이 나지 않을까 눈치를 보면서 메시지를 보내는 통신 방식



### 네트워크 장비

- 네트워크 분배 장치 - **허브**

  - 여러개의 LAN 포트
  - 하나의 데이터를 목적지까지 한 번에 보내는 게 아니라 연결된 모든 장치에 보낸 다음, 데이터 수신자가 직접 자신이 목적지인지 아닌지를 MAC 주소로 판단하게끔 맡기는 것이다.
  - 허브는 네트워크를 분배하는 역할만 수행하고, 데이터의 수신지를 구분해서 목적지에 전달하는 기능은 없기 때문
  - 네트워크 회선에서 지원하는 대역폭을 충분히 보장하지 못한다.
  - 허브에 연결되는 단말장치가 많으면 많을수록 데이터 충돌도 증가하기 때문에 네트워크의 데이터 전송속도가 감소하며, 전반적인 네트워크 성능이 떨어진다.

- 허브의 업그레이드 버전 - **스위치**

  - 허브의 네트워크 분배 과정에서 발생하는 데이터의 충돌 영역을 줄이고, 네트워크의 전송 대역폭을 보장하기 위해 개발된 네트워크 장비
  - 핵심은 **MAC 주소 테이블**
  - MAC 주소를 기준으로 단말장치가 스위치의 어느 포트를 통해 나가야 할지 정의한 표
  - 네트워크 규모가 클수록 관리해야할 스위치 수가 많아진다.
  - 스위치는 자신을 통해 오가는 데이터에 포함된 MAC 주소 정보로 MAC 주소 테이블을 갱신하여 이를 활용한다.
  - **ARP**(Address Resolution Protocol)

  ![IMG_0827](https://user-images.githubusercontent.com/46207836/120475324-2b384580-c3e4-11eb-86a8-2c65f0baa1f1.JPG)

### 허브와 스위치 비교

허브 : 모든 단말장치로 데이터를 보내어 단말장치 스스로가 수신한 데이터의 MAC 주소와 단말장치 자신의 MAC 주소를 비교하여 데이터의 수신여부 결정

스위치 : 단말장치가 아닌 스위치가 MAC 주소 테이블을 통해 경로를 결정하고 목적지에 맞는 단말장치에만 데이터를 전달

- 이러한 스위치의 통신 방식은 데이터의 충돌 영역 때문에 발생할 수 있는 문제를 크게 줄인다.

- 스위치에 연결된 단말장치들이 서로 영향을 주지 않기 때문에 특정 단말장치가 데이터를 보내더라도 다른 단말 장치에서도 동시에 속도 저하 없이 회선에서 지원하는 동일한 속도로 데이터를 전송할 수 있다.
- 즉, 스위치에 연결된 네트워크 회선에서 3Mbps의 전송 대역폭을 지원한다면 스위치에 연결된 모든 단말장치에 동일한 3Mbps의 전송 대역폭이 보장된다.





- 서로 다른 네트워크를 연결하는 **라우터**

![](https://yohanpro.com/media/images/network/router-1.png)

- 라우터가 통신을 중계하는 방법 - **라우팅 테이블**

앞선 단말장치들은 ARP 테이블에 등록된 MAC 주소 정보를 가지고 데이터를 생성할 수 있었고, 스위치 장비들은 MAC 주소 테이블을 가지고 해당 데이터들을 목적지까지 전달할 수 있다.

**ARP 테이블 vs MAC 주소 테이블 vs 라우팅 테이블**

라우팅테이블에는 라우터와 연결된 네트워크 주소별로 데이터를 내보내기 위한 출력 인터페이스가 정의

![IMG_0828](https://user-images.githubusercontent.com/46207836/120515542-5d0fd300-c409-11eb-9306-164691797bf7.JPG)

1. 네트워크 A로부터 데이터를 전달받은 라우터는 제일 먼저 데이터에 지정된 목적지 IP주소를 확인

2. 해당 목적지 IP 주소를 가지고 라우팅 테이블에서 해당 IP 주소가 어느 네트워크 주소에 해당되는지 찾기 (w/ 서브넷 마스크 주소)

3. 계산된 네트워크 주소값이 라우팅 테이블의 네트워크 주소값과 일치하는지 확인

   즉, 목적지 IP 주소가 라우팅 테이블의 네트워크 주소와 동일한 네트워크에 속한다



- 라우터의 최적 경로 설정 방법 - 라우팅(Routing)

- 정적 라우팅 프로토콜

  - 네트워크 관리자가 데이터를 목적지까지 보낼 최적 경로를 직접 결정하고 경로상의 존재하는 라우터 장비의 라우팅 테이블을 수동으로 입력하여 고정적인 경로를 설정하는 방법

- 동적 라우팅 프로토콜

  - Distance Vector? Link State?
  - 라우터 장비들은 인접한 다른 라우터들과 연결 정보를 주기적으로 교환하여 각각의 연결 정보를 파악하고, 특정 기준에 따라 경로를 결정하여 그 경로에 속해 있는 라우터 장비의 라우팅 테이블을 갱신
  - 라우터가 라우팅 경로를 결정할 때 고려하는 특정한 기준을 라우팅 프로토콜에서는 메트릭(Metric)
    - Hop Count - RIP
    - 대역폭, 지연, 신뢰도, MTU(데이터 최대 전송단위) - IGRP, EIGRP
    - 전송 속도(Link Cost) - OSPF

  

  ![IMG_0830](https://user-images.githubusercontent.com/46207836/120521275-ba0e8780-c40f-11eb-96ab-1a73f7575c8e.JPG)

  다음홉 : 데이터가 목적지까지 가는 경로에서 현재 라우터와 동일한 경로에 있는 바로 다음 홉의 주소

  R1은 전달받은 R2의 라우팅 테이블을 가지고 라우팅 테이블 갱신 알고리즘을 활용하여 자신의 라우팅 테이블을 갱신한다.

  먼저 R1은 R2의 라우팅 테이블을 전달받으면 먼저 전달받은 라우팅 테이블의 목적지가 R1의 라우팅 테이블에 존재하는지 확인한다. 여기서 라우터 R4, 네트워크B의 목적지 정보가 존재하지 않음으로 해당 정보를 가지고 라우터 R1의  라우팅 테이블 정보를 추가한다. 그리고 더는 갱신해줄 정보가 없으므로 라우팅 테이블 갱신 알고리즘은 여기까지 진행하고 종료한다.

  ![IMG_0831](https://user-images.githubusercontent.com/46207836/120521282-bb3fb480-c40f-11eb-8757-80f480be9ce4.jpg)

여기서 끝나지 않는다. 라우터 R1은 라우터 R2뿐만 아니라 R3의 라우팅 테이블 정보도 전달받기 때문에 R1의 라우팅 테이블은 한 번 더 갱신된다. 우선 라우터 R3의 라우팅 테이블을 라우팅 테이블을 전달받은 라우터 R1은 이를 그대로 활용하지 않는다. R1의 입장에서 R3의 라우팅 테이블에 나온 경로 정보는 모두 R3를 지나는 경로이기 때문에 비용은 1이 증가하고 다음 홉은 R3로 수정된다.

이제 R1은 전달받은 R3의 라우팅 테이블을 가지고 라우팅 테이블 갱신 알고리즘을 활용하여 자신의 라우팅 테이블을 한 번 더 갱신한다. 먼저 라우터 R1은 R3의 라우팅 테이블을 전달받으면 먼저 자신의 라우팅 테이블에서 목적지의 비용 값과 다음 홉 값이 정의되지 않은 경우가 있다면, 전달 받은 R3 라우팅 테이블에 해당 값들이 존재하는지 확인한다. 하지만 이미 R1의 라우팅 테이블에서 목적지별 비용값과 다음 홉값을 모두 가지고 있으므로 이는 건너 뛴다. 

다음으로는 R1의 라우팅 테이블과 R1이 전달받은 R3 라우팅 테이블에서 목적지별 다음 홉값이 동일한지 비교한다. 그리고 마지막으로 두 라우팅 테이블에서 서로 다음 홉값이 일치하지 않는 목적지 R2와 R4의 비용 값의 크기를 비교한다.이 때 R3 라우팅 테이블의 비용값이 기존 R1라우팅 테이블의 비용 값보다 작거나 같다면 해당되는 R3 라우팅 테이블 목적지의 비용값과 다음 홉값으로 R1라우팅 테이블을 갱신한다.(변경 아니고 **추가**!!!)



### 홉카운트가 같은 경로가 여럿일 때는 데이터를 어디로 보내야할까?

RIP는 데이터를 목적지까지 전달할 때, 가장 적은 홉카운트를 가지는 경로로 라우팅 테이블을 갱신하여 데이터를 전달한다. 그런데 이때 갱신된 라우팅 테이블에서 목적지는 같은데 최소 홉카운트가 동일한 경로가 여러 개라면, 라우터는 도대체 어떤 경로로 데이터를 보내야할까?

결론 : 홉카운트가 최소인 **모든** 경로로 데이터를 보낸다.

모든 경로를 모두 이용하여 데이터를 보냄으로써 하나의 경로로만 몰리는 부하를 분산하여 목적지까지 빠르게 데이터를 보낼 수 있다. 네트워크에서는 이런 기능을 데이터의 부하를 분산하여 데이터 흐름의 균형을 맞춘다는 의미로 **로드 밸런싱(Load Balancing)**이라고 한다.



### RIP의 한계

홉카운트가 적은 라우팅 경로가 반드시 최적 경로인 것은 아니다.

전송속도를 고려.



- 네트워크의 관문 - 게이트웨이

작은 규모의 사설망에서 인터넷과 같은 규모가 큰 외부망으로 데이터를 보내거나 받을 수 있는 일종의 관문 역할을 수행하는 네트워크 장비

- 게이트웨이 ? 네트워크?

  - 서로 다른 네트워크를 연결한다는 개념만 보면 게이트웨이는 라우터와 동일한 장비일까? 

  - 라우터의 가장 큰 역할은 최적 경로 설정(라우팅)

    - 각 라우터들은 최적의 경로를 설정하여 라우팅 테이블을 갱신한다. 

  - 이 때, 라우터 2는 네트워크 A에서 네트워크 B로 데이터를 보내기 위한 첫 관문이 되는 것

    , 반대로 라우터 4는 네트워크 B에서 네트워크 A로 데이터를 보내기 위한 첫 관문의 역할

  - 라우터 2와 라우터 4는 각각 네트워크 A,B의 게이트웨이 역할을 하는 것이다.
  - 우리가 가정이나 사무실에서 흔히 사용하는 유무선공유기의 경우 IPTV, PC, AI 스피커 등 여러 단말장치를 동일한 네트워크로 묶는 허브 및 스위치의 역할을 한다.
  - 동시에 해당 단말들이 유무선공유기를 통해 인터넷에 연결될 수 있게 하는 게이트웨이 역할도 한다.
  - 즉 게이트웨이 역할을 하는 장비가 반드시 라우터만 있는 것은 아니다.

- 네트워크의 충전소 - 리피터

  - 데이터 전송 거리가 길면 길수록 전압 세기가 감소하기 때문에 전송거리가 길면 디지털 신호의 세기도 감소한다. 
  - 그래서 데이터 신호가 약해지는 지점마다 리피터를 설치하여 감소한 데이터 신호를 증폭하고, 전송 거리가 짧아 도착지에 도달하지 못한 데이터를 재전송함으로써 데이터가 목적지까지 전달될 수 있게 한다.

- 스마트폰의 리피터 장비 - 기지국

  - 기지국들은 자신의 통신 범위 안에 있는 스마트폰의 데이터

![IMG_0836](https://user-images.githubusercontent.com/46207836/120744319-b117d600-c535-11eb-8bfd-cb6af28d050b.JPG)

